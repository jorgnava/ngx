!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/common/http"),require("@ionic/storage"),require("@ionic/angular"),require("@ionic/core/dist/collection/utils/transition/ios.transition"),require("@ionic/core/dist/collection/utils/transition/md.transition"),require("@angular/core")):"function"==typeof define&&define.amd?define("@okode/ngx-common",["exports","@angular/common/http","@ionic/storage","@ionic/angular","@ionic/core/dist/collection/utils/transition/ios.transition","@ionic/core/dist/collection/utils/transition/md.transition","@angular/core"],e):e((t.okode=t.okode||{},t.okode["ngx-common"]={}),t.ng.common.http,t.storage,t.angular,t.ios_transition,t.md_transition,t.ng.core)}(this,function(t,e,n,o,a,i,r){"use strict";var s=function(){return(s=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function u(e,a,s,u){return new(s||(s=Promise))(function(t,n){function o(t){try{r(u.next(t))}catch(e){n(e)}}function i(t){try{r(u["throw"](t))}catch(e){n(e)}}function r(e){e.done?t(e.value):new s(function(t){t(e.value)}).then(o,i)}r((u=u.apply(e,a||[])).next())})}function c(o,i){var r,a,s,t,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),"throw":e(1),"return":e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function n(t){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,a&&(s=2&t[0]?a["return"]:t[0]?a["throw"]||((s=a["return"])&&s.call(a),0):a.next)&&!(s=s.call(a,t[1])).done)return s;switch(a=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,a=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){u.label=t[1];break}if(6===t[0]&&u.label<s[1]){u.label=s[1],s=t;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(t);break}s[2]&&u.ops.pop(),u.trys.pop();continue}t=i.call(o,u)}catch(e){t=[6,e],a=0}finally{r=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([e,t])}}}var l=function(){function i(t,e,n,o){this.http=t,this.storage=e,this.actionSheetCtrl=n,this.platform=o,this.JSON_PATH="assets/environments.json",this.SELECTED_ENVIRONMENT_KEY="selectedEnvironmentKey",this.isInitializing=!1,this.readyPromiseResolve=[],this.readyPromiseReject=[]}return i.config=function(){return i.isReady||console.error("Environment config is not ready (wait for Environment.ready())"),i.environmentConfig},i.prototype.ready=function(){var n=this;return i.isReady?Promise.resolve():(this.isInitializing||(this.isInitializing=!0,this.initEnvs()),new Promise(function(t,e){n.readyPromiseResolve.push(t),n.readyPromiseReject.push(e)}))},i.prototype.initEnvs=function(){var i=this;this.http.get(this.JSON_PATH).subscribe(function(n){if(null==n||0===Object.keys(n).length)return i.readyPromiseReject.forEach(function(t){return t()}),void console.error("EnvironmentService fails: '"+i.JSON_PATH+"' is empty or invalid");var o=Object.keys(n).filter(function(t){return"default"!==t});null==o||0===o.length?i.setEnv(!1,"default",n["default"]):i.storage.ready().then(function(){i.storage.get(i.SELECTED_ENVIRONMENT_KEY).then(function(t){if(null==t)if(1<o.length)console.log("No saved environment detected, will prompt user for selection"),i.showEnvironmentActionSheet(o,n);else{var e=o[0];i.setEnv(!0,e,n["default"],n[e])}else console.log("Detected saved environment: "+t),i.setEnv(!1,t,n["default"],n[t])})})},function(t){console.log(t),console.error("EnvironmentService fails: Not found '"+i.JSON_PATH+"'"),i.readyPromiseReject.forEach(function(t){return t()})})},i.prototype.setEnv=function(t,e,n,o){console.log("Applying environment: "+e),i.environmentConfig=n,null!=o&&(i.environmentConfig=s({},n,o)),t&&(console.log("Saving environment: "+e),this.storage.set(this.SELECTED_ENVIRONMENT_KEY,e)),i.isReady=!0,this.readyPromiseResolve.forEach(function(t){return t()})},i.prototype.showEnvironmentActionSheet=function(n,o){return u(this,void 0,void 0,function(){var e=this;return c(this,function(t){switch(t.label){case 0:return[4,this.platform.ready()];case 1:return t.sent(),[4,this.actionSheetCtrl.create({header:"Select environment",backdropDismiss:!1,buttons:n.map(function(t){return{text:t,handler:function(){e.setEnv(!0,t,o["default"],o[t])}}})})];case 2:return t.sent().present(),[2]}})})},i.isReady=!1,i.environmentConfig={},i.decorators=[{type:r.Injectable}],i.ctorParameters=function(){return[{type:e.HttpClient},{type:n.Storage},{type:o.ActionSheetController},{type:o.Platform}]},i}(),f=function(){function t(t,e){this.navCtrl=t,this.config=e,this.animation="push",this.setAnimationConfig()}return t.prototype.getParams=function(){return this.params},t.prototype.push=function(t,e,n){return void 0===n&&(n="push"),this.params=e,this.animation=n,this.navCtrl.navigateForward(t)},t.prototype.pop=function(t,e){return this.params=e,this.navCtrl.navigateBack(t||this.getPreviousPageUrl())},t.prototype.popToRoot=function(){return this.navCtrl.navigateBack(this.getRootPageUrl())},t.prototype.setRoot=function(t,e){return this.params=e,this.navCtrl.navigateRoot(t)},t.prototype.getViews=function(){var t=s({},this.navCtrl),e=[];return t&&t.topOutlet&&t.topOutlet.stackCtrl&&(e=t.topOutlet.stackCtrl.views),e},t.prototype.getPreviousPageUrl=function(){var t=this.getViews();return t&&1<t.length?t[t.length-2].url:""},t.prototype.getRootPageUrl=function(){var t=this.getViews();return t&&t.length?t[0].url:""},t.prototype.setAnimationConfig=function(){var r=this;this.config.set("navAnimation",function(t,e,n){var o=r.animation;switch("back"===n.direction&&(o=n.enteringEl.getAttribute("animation-leave")),n.enteringEl.setAttribute("animation-enter",r.animation),n.leavingEl.setAttribute("animation-leave",r.animation),(n&&"ios"===n.mode?"ios":"md")+"_"+o){case"ios_push":return function i(t,e,n){return a.iosTransitionAnimation(t,e,n)}(t,e,n);case"ios_modal":return p(t,e,n);case"ios_fade":return d(t,e,n);case"md_push":case"md_modal":return p(t,e,n);case"md_fade":return d(t,e,n);default:return p(t,e,n)}})},t.decorators=[{type:r.Injectable}],t.ctorParameters=function(){return[{type:o.NavController},{type:o.Config}]},t}();function p(t,e,n){return i.mdTransitionAnimation(t,e,n)}function d(t,e,n){return h(t,e,n)}function h(t,e,n){var o=function(t){return t.classList.contains("ion-page")?t:t.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||t},i=n.enteringEl,r=n.leavingEl,a=o(i),s=new t;s.addElement(a).beforeRemoveClass("ion-page-invisible"),"back"===n.direction?s.duration(n.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):s.duration(n.duration||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("opacity",.01,1,!0);var u=a.querySelector("ion-toolbar");if(u){var c=new t;c.addElement(u),s.add(c)}if(r&&"back"===n.direction){s.duration(n.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)");var l=new t;l.addElement(o(r)).fromTo("opacity",1,0),s.add(l)}return Promise.resolve(s)}var v=function(){function t(){}return t.forRoot=function(){return{ngModule:t,providers:[l,f,{provide:r.APP_INITIALIZER,useFactory:m,deps:[l],multi:!0}]}},t.decorators=[{type:r.NgModule,args:[{declarations:[],imports:[],exports:[]}]}],t}();function m(e){var t=this;return function(){return u(t,void 0,void 0,function(){return c(this,function(t){switch(t.label){case 0:return[4,e.ready()];case 1:return t.sent(),[2]}})})}}t.Environment=l,t.fadeAnimation=h,t.Navigator=f,t.envInitializer=m,t.OkodeNgxCommonModule=v,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=okode-ngx-common.umd.min.js.map